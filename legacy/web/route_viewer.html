<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ArcticRoute Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-o9N1j7kGStGkzPqkXG8tG87ZLkF3TTxQ6G6bYwii0Xk="
    crossorigin=""
  />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .route-list {
      position: absolute;
      bottom: 16px;
      left: 16px;
      background: rgba(255, 255, 255, 0.85);
      padding: 8px 12px;
      border-radius: 6px;
      max-height: 200px;
      overflow-y: auto;
      font-family: sans-serif;
      font-size: 13px;
    }
    .route-list h3 {
      margin: 0 0 6px;
      font-size: 14px;
    }
    .route-list ul {
      margin: 0;
      padding: 0 0 0 16px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="route-list" id="routeList" hidden>
    <h3>Loaded Routes</h3>
    <ul id="routeItems"></ul>
  </div>
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-o9N1j7kGStGkzPqkXG8tG87ZLkF3TTxQ6G6bYwii0Xk="
    crossorigin=""
  ></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
  <script src="assets/route_viewer.js"></script>
  <script>
    const ROUTE_FILES = [
      "route_acc_s.geojson",
      "route_acc_t.geojson",
      "route_base.geojson",
      "route_baseline.geojson",
      "route_20251029_123011.geojson",
      "route_corridor.geojson",
      "route_corr.geojson",
      "route_corr_check.geojson",
      "route_cache_run.geojson",
      "route_cache_run2.geojson",
      "route_override.geojson"
    ];

    const ROUTE_CONFIG = ROUTE_FILES.map((name, idx) => ({
      name,
      path: `../ArcticRoute/outputs/${name}`,
      color: ["#ff0000", "#0080ff", "#ff7f0e", "#2ca02c", "#9467bd", "#8c564b", "#d62728", "#17becf", "#bcbd22", "#7f7f7f", "#e377c2"][idx % 11]
    }));

    document.addEventListener("DOMContentLoaded", async () => {
      const overlayConfigPath = "../ArcticRoute/outputs/overlays/risk_t0_bounds.json";
      const overlayImagePath = "../ArcticRoute/outputs/overlays/risk_t0.png";
      const hotspotsPath = "../outputs/acc_hotspots.geojson";

      const viewer = await initRouteViewer({
        mapId: "map",
        overlayConfigPath,
        overlayImagePath,
        routesGlob: ROUTE_CONFIG,
        hotspotsPath,
        enableHeatmap: true
      });

      const routeNames = Object.keys(viewer.routeLayers);
      if (routeNames.length > 0) {
        const list = document.getElementById("routeList");
        const items = document.getElementById("routeItems");
        list.hidden = false;
        routeNames.forEach(name => {
          const li = document.createElement("li");
          li.textContent = name;
          items.appendChild(li);
        });
      }
    });
  </script>
</body>
</html>
